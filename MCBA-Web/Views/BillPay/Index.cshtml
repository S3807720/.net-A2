@model MCBA_Web.ViewModels.BillPayViewModel
@{
    ViewData["Title"] = "Accounts";
}

<div>
    <h1 class="display-4">Welcome, @Model.Customer.Name</h1>

    <h3>Your Accounts</h3>
    <table class="table table-striped table-dark">
        @using (Html.BeginForm("Index", "Home", FormMethod.Post, new { @Id = "WebGridForm" }))
        {
            @Html.DropDownListFor(m => m.Account,
               new SelectList(Model.Accounts, "AccountNumber", "AccountNumber"),
          "Select Account", new { style = "width:250px", @class = "dropdown1" })
        }
        <tr>
            <th>@Html.DisplayNameFor(x => x.BillPays[0].BillPayID)</th>
            <th>@Html.DisplayNameFor(x => x.BillPays[0].Amount)</th>
            <th>@Html.DisplayNameFor(x => x.BillPays[0].AccountNumber)</th>
            <th>@Html.DisplayNameFor(x => x.BillPays[0].Period)</th>
            <th>@Html.DisplayNameFor(x => x.BillPays[0].ScheduleTimeUtc)</th>
            <th></th>
        </tr>
        @foreach (var bpay in Model.BillPays)
        {
            <tr>
                @{ var time = bpay.ScheduleTimeUtc.ToLocalTime();
                    <td>@Html.DisplayFor(x => bpay.BillPayID)</td>
                    <td>@Html.DisplayFor(x => bpay.Amount)</td>
                    <td>@Html.DisplayFor(x => bpay.AccountNumber)</td>
                    <td>@Html.DisplayFor(x => bpay.Period)</td>
                    <td>@time</td>
                }
            <td>
                <input type="hidden" name="customerID" value="@bpay.AccountNumber" />
                <a class="btn btn-primary"
                   asp-action="Pay" asp-route-id="@bpay.AccountNumber">
                    Pay
                </a>
                <a class="btn btn-primary"
                   asp-action="Edit" asp-route-id="@bpay.AccountNumber">
                    Edit
                </a>
                <a class="btn btn-primary"
                   asp-action="Cancel" asp-route-id="@bpay.AccountNumber">
                    Cancel
                </a>
            </td>
            </tr>
        }
    </table>
</div>
